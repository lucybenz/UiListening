# UI Element Monitor (UI元素监控工具)

一个 Windows 桌面应用，用于监控任意 UI 元素的值变化，当满足设定条件时播放音效提醒。

## 功能特点

- **鼠标选择元素**：通过鼠标直接选择桌面上任意应用程序的 UI 元素
- **多种监控条件**：支持 `>`、`<`、`=`、`>=`、`<=`、`!=`、`包含`、`不包含` 等条件
- **值提取方式**：支持原始值、提取数字、提取整数、提取小数、去除空格、取长度等处理方式
- **音效提醒**：条件触发时循环播放音效，移动鼠标自动停止
- **配置持久化**：监控配置自动保存，重启后自动恢复

## 使用场景

- 监控股票/交易软件中的价格变化
- 监控下载进度达到指定值
- 监控游戏中的数值变化
- 监控任意软件中需要关注的数据

## 安装

### 方式一：直接运行 (需要 Python 环境)

```bash
# 克隆仓库
git clone https://github.com/你的用户名/MouseSelectFind.git
cd MouseSelectFind

# 安装依赖
pip install -r requirements.txt

# 运行
python main.py
```

### 方式二：使用打包好的 exe

从 [Releases](../../releases) 页面下载最新版本的 exe 文件直接运行。

## 使用方法

### 1. 添加监控

1. 点击 **"添加监控 (鼠标选择)"** 按钮
2. 将鼠标移动到目标元素上，元素会显示红色边框高亮
3. 按 **Ctrl + 鼠标左键** 确认选择（按 **ESC** 取消）
4. 在弹出的配置对话框中设置：
   - **提取方式**：选择如何处理元素的值
   - **条件**：选择触发条件
   - **目标值**：设置触发的阈值
   - **音效文件**：选择提醒音效（默认使用自带的 12788.wav）
   - **检测间隔**：设置检测频率（秒）

### 2. 管理监控

- **删除选中**：选中列表中的监控项后点击删除
- **停止音效**：手动停止正在播放的提醒音效（或移动鼠标自动停止）

### 3. 监控列表说明

| 列名 | 说明 |
|------|------|
| 元素名称 | 被监控元素的名称或标识 |
| 条件 | 触发条件 |
| 目标值 | 触发阈值 |
| 音效文件 | 提醒音效文件名 |
| 状态 | 当前状态（监控中/已触发/错误） |
| 当前值 | 元素的实时值 |

## 系统要求

- Windows 10/11
- Python 3.8+ (源码运行时)

## 依赖

- `uiautomation` - Windows UI 自动化
- `pynput` - 鼠标键盘监听
- `pygame` - 音效播放

## 打包为 exe

```bash
pip install pyinstaller
pyinstaller main.spec
```

打包后的文件在 `dist` 目录下。

## 注意事项

- 部分应用程序的 UI 元素可能无法被正确识别
- 某些元素的值可能需要使用"提取数字"等方式处理后才能进行数值比较
- 建议以管理员权限运行以获得更好的元素访问能力

## License

MIT
